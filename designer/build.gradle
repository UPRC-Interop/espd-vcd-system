apply plugin: 'war'
apply from: 'https://raw.github.com/akhikhl/gretty/master/pluginScripts/gretty.plugin'


/**
 * Run gradle task jettyRun to start jetty
 * and jettyStop to stop it.
 */
buildscript {
    repositories {
//        jcenter()
        jcenter {
            url "http://jcenter.bintray.com/"
        }
    }

    dependencies {
        classpath 'org.akhikhl.gretty:gretty:+'
    }
}

repositories {
    jcenter()
    maven {
        url "http://maven.vaadin.com/vaadin-addons"
    }
}

apply plugin: 'org.akhikhl.gretty'

gretty {
    httpPort                = 8080
    contextPath             = '/'
    scanInterval            = 1
    servletContainer        = 'jetty9'
    redeployMode            = 'redeploy'
//    managedClassReload      = true
    fastReload              = true
    recompileOnSourceChange = true
    reloadOnClassChange     = true
    reloadOnConfigChange    = true
    reloadOnLibChange       = true
    inplaceMode             = 'soft'
    loggingLevel            = 'INFO'
    consoleLogEnabled       = true
    fileLogEnabled          = true
    logDir                  = "${project.buildDir}"
    logFileName             = "${project.name}"
    
    jvmArgs= ['-Dorg.eclipse.jetty.annotations.maxWait=120']
}

dependencies {
    compile project(':builder')
    compile project(':codelists')
    compile project(':model')
    compile 'com.vaadin:vaadin-server:8.0.4'
    compile 'com.vaadin:vaadin-client-compiled:8.0.4'
    compile 'com.vaadin:vaadin-client-compiler:8.0.4'
    compile 'com.vaadin:vaadin-themes:8.0.4'
//    compile 'org.vaadin.addons:jain-i18N:1.1.9'
}

task copyTask(type: Copy) {
    from "build/libs/designer-${version}.war"
    into '../artifacts'
    rename "designer-${version}.war", 'designer.war'
}

build.dependsOn copyTask
